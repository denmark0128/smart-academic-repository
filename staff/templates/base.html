
<script>
  // Apply stored or preferred theme *before* page renders
  const storedTheme = localStorage.getItem("color-theme");
  const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

  if (storedTheme === "dark" || (!storedTheme && prefersDark)) {
    document.documentElement.classList.add("dark");
  } else {
    document.documentElement.classList.remove("dark");
  }
</script>


  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { inter: ["Inter", "sans-serif"] },
        },
      },
    };
  </script>

  <!-- DaisyUI (optional theme components) -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@2.0.4"></script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- NProgress -->
  <link rel="stylesheet" href="https://unpkg.com/nprogress@0.2.0/nprogress.css">
  <style>
    #nprogress .bar {
      background: #000000;
      height: 3px;
    }
    [x-cloak] { display: none !important; }

    mark {
    background-color: #fde68a; /* Tailwind's yellow-200 */
    color: #111827; /* gray-900 */
    border-radius: 0.25rem;
    padding: 0 2px;
    }
    .dark mark {
      background-color: #854d0e; /* amber-800 */
      color: #f9fafb; /* gray-50 */
    }
    input[type="search"]::-webkit-search-cancel-button {
      -webkit-appearance: none;
      appearance: none;
      display: none;
    }

    input[type="search"]::-ms-clear {
      display: none;
    }

    input[type="search"]::-moz-clear {
      display: none;
    }
    select {
      @apply dark:bg-zinc-800 dark:text-zinc-300 dark:border-zinc-700;
    }
  </style>

  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

  {% load static %}
  {% block extra_head %}{% endblock %}
</head>

<body class="min-h-screen bg-gray-50 dark:bg-black
  text-zinc-900 dark:text-zinc-100 font-inter transition-colors duration-300 
  flex flex-col">

  {% if not hide_navbar %}
    {% include 'components/navbar_staff.html' %}
  {% endif %}

  <div id="main-content" class="container  mx-auto px-6 py-2">
    {% block content %}{% endblock %}
  </div>

  <!-- Toast container -->b
  <div id="toast-container" class="fixed top-5 right-5 z-50 space-y-2"></div>

  <!-- NProgress JS -->
  <script src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
  
  {% block extra_scripts %}{% endblock %}

<script>
document.body.addEventListener('htmx:configRequest', (event) => {
    event.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
});


  // Clears input after the request is SENT
  document.body.addEventListener("htmx:afterRequest", (evt) => {
    // Make sure this event is from our form
    if (evt.detail.elt.id === "chat-form") {
      document.getElementById("chat-input").value = "";
    }
  });

  document.body.addEventListener("htmx:afterSwap", (evt) => {
    // Also make sure this event is from our chat form
    if (evt.detail.elt.id === "chat-form") {
      
      // Find the container that scrolls
      const chatContainer = document.getElementById("chat-container");
      
      // Set its scroll position to the very bottom
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    });
</script>

</body>
</html>
