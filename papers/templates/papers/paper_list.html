{% extends 'layouts/base.html' %}

{% block title %}Paper List{% endblock %}

{% block content %}
<div class="flex flex-col items-center min-h-[60vh]">
  <div class="w-full max-w-5xl">
    <h1 class="text-3xl font-serif font-bold text-gray-800 mb-4 text-center tracking-tight">Academic Papers</h1>
    <form action="{% url 'paper_list' %}" method="get" class="flex flex-col sm:flex-row gap-2 items-center justify-center mb-6">
      <input type="search" class="w-full sm:w-2/3 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-200 focus:outline-none transition" placeholder="Search papers, authors, or topics..." name="q" value="{{ request.GET.q }}">
      <button type="submit" class="px-6 py-2 bg-blue-700 text-white rounded-md font-semibold hover:bg-blue-800 transition">Search</button>
    </form>
    <div class="flex justify-end mb-4">
      <a href="{% url 'paper_upload' %}" class="inline-block px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium transition">Upload New Paper</a>
    </div>
    <div class="overflow-x-auto rounded-xl shadow-lg">
      <table class="min-w-full border border-gray-200 bg-white rounded-xl">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Title</th>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Author</th>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Uploaded At</th>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Score</th>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Page</th>
          </tr>
        </thead>
        <tbody>
          {% for item in results %}
          <tr class="hover:bg-blue-50 transition">
            <td class="px-4 py-3 align-top border-b border-gray-100">
              <a href="{% url 'paper_detail' item.paper.pk %}" class="text-blue-700 hover:underline font-medium">
                {{ item.paper.title }}
              </a>
              {% if item.snippet %}
                <p class="text-gray-500 text-sm mt-1">… {{ item.snippet|safe }} …</p>
              {% endif %}
              {% if item.tags %}
                <div class="mt-2 space-x-2 text-xs">
                  {% for tag in item.tags %}
                    <span class="inline-block bg-gray-200 text-gray-700 px-2 py-1 rounded">
                      {{ tag }}
                    </span>
                  {% endfor %}
                </div>
              {% endif %}
            </td>
            <td class="px-4 py-3 border-b border-gray-100">{{ item.paper.author }}</td>
            <td class="px-4 py-3 border-b border-gray-100">{{ item.paper.uploaded_at|date:"M d, Y H:i" }}</td>
            <td class="px-4 py-3 border-b border-gray-100">{{ item.score|default:"-" }}</td>
            <td class="px-4 py-3 border-b border-gray-100">{{ item.page|default:"-" }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
