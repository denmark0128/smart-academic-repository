{% extends 'layouts/base.html' %}

{% block title %}Paper List{% endblock %}

{% block content %}
<div class="flex flex-col items-start min-h-[60vh]">
  <div class="w-full max-w-5xl px-4">

    <!-- Search Results -->
    {% for item in results %}
      <div class="mb-8 border-b border-gray-200 pb-4">
        <!-- Title -->
        <a href="{% url 'paper_detail' item.paper.pk %}" class="text-xl text-blue-700 font-semibold hover:underline">
          {{ item.paper.title }}
        </a>

        <!-- Author and Upload Date -->
        <div class="text-sm text-gray-500 mt-1">
          By {{ item.paper.author }} â€¢ {{ item.paper.uploaded_at|date:"M d, Y H:i" }}
        </div>

        <!-- Snippet -->
        <div x-data="{ expanded: false }" class="mt-2 text-gray-600 text-sm leading-relaxed">
            {% if item.snippet|length > 180 %}
              <!-- Collapsed view -->
              <span x-show="!expanded">
                 {{ item.snippet|truncatechars_html:180|safe }} 
                <button @click="expanded = true" class="text-blue-600 hover:underline text-xs ml-1">Read more</button>
              </span>

              <!-- Expanded view -->
              <span x-show="expanded">
                 {{ item.snippet|safe }} 
                <button @click="expanded = false" class="text-blue-600 hover:underline text-xs ml-1">See less</button>
              </span>
            {% else %}
               {{ item.snippet|safe }} 
            {% endif %}
          </div>


        <!-- Tags -->
        {% if item.tags %}
          <div class="mt-3 flex flex-wrap gap-2 text-xs">
            {% for tag in item.tags %}
              <span class="inline-block bg-gray-200 text-gray-700 font-semibold px-2 py-1 rounded-full">
                {{ tag }}
              </span>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    {% empty %}
      <div class="text-center text-gray-500 mt-12">No results found.</div>
    {% endfor %}

  </div>
</div>
{% endblock %}
